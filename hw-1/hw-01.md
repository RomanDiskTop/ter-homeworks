# Домашнее задание к занятию «Введение в Terraform»

### Задание 1

1. Перейдите в каталог [**src**](https://github.com/netology-code/ter-homeworks/tree/main/01/src). Скачайте все необходимые зависимости, использованные в проекте. 
2. Изучите файл **.gitignore**. В каком terraform-файле, согласно этому .gitignore, допустимо сохранить личную, секретную информацию?(логины,пароли,ключи,токены итд)
3. Выполните код проекта. Найдите  в state-файле секретное содержимое созданного ресурса **random_password**, пришлите в качестве ответа конкретный ключ и его значение.
4. Раскомментируйте блок кода, примерно расположенный на строчках 29–42 файла **main.tf**.
Выполните команду ```terraform validate```. Объясните, в чём заключаются намеренно допущенные ошибки. Исправьте их.
5. Выполните код. В качестве ответа приложите: исправленный фрагмент кода и вывод команды ```docker ps```.
6. Замените имя docker-контейнера в блоке кода на ```hello_world```. Не перепутайте имя контейнера и имя образа. Мы всё ещё продолжаем использовать name = "nginx:latest". Выполните команду ```terraform apply -auto-approve```.
Объясните своими словами, в чём может быть опасность применения ключа  ```-auto-approve```. Догадайтесь или нагуглите зачем может пригодиться данный ключ? В качестве ответа дополнительно приложите вывод команды ```docker ps```.
8. Уничтожьте созданные ресурсы с помощью **terraform**. Убедитесь, что все ресурсы удалены. Приложите содержимое файла **terraform.tfstate**. 
9. Объясните, почему при этом не был удалён docker-образ **nginx:latest**. Ответ **ОБЯЗАТЕЛЬНО НАЙДИТЕ В ПРЕДОСТАВЛЕННОМ КОДЕ**, а затем **ОБЯЗАТЕЛЬНО ПОДКРЕПИТЕ** строчкой из документации [**terraform провайдера docker**](https://library.tf/providers/kreuzwerker/docker/latest).  (ищите в классификаторе resource docker_image )

### Ответ на Задание 1

![Cкриншот «Задание 1»](img/image1-1.png)

```
1 ошибка
Небыло имени ресурса nginx

│ Error: Missing name for resource
│ 
│   on main.tf line 22, in resource "docker_image":
│   22: resource "docker_image" {
│ 
│ All resource blocks must have 2 labels (type, name).

resource "docker_image" "nginx" {
  name         = "nginx:latest"
  keep_locally = true
}

2 ошибка
Тут имена ресурсов терраформа не могут начинаться с цифры

│ Error: Invalid resource name
│ 
│   on main.tf line 27, in resource "docker_container" "1nginx":
│   27: resource "docker_container" "1nginx" {
│ 
│ A name must start with a letter or underscore and may contain only letters, digits, underscores, and dashes.

resource "docker_container" "nginx" {
  image = docker_image.nginx.image_id
  name  = "example_${random_password.random_string_FAKE.resulT}"

  ports {
    internal = 80
    external = 9090
  }
}

ошибка 3
Обявлена random_password.random_string, а написанно random_password.random_string_FAKE
Опечатка в resulT

│ Error: Reference to undeclared resource
│ 
│   on main.tf line 29, in resource "docker_container" "nginx":
│   29:   name  = "example_${random_password.random_string_FAKE.result}"
│ 
│ A managed resource "random_password" "random_string_FAKE" has not been declared in the root module.

resource "docker_container" "nginx" {
  image = docker_image.nginx.image_id
  name  = "example_${random_password.random_string.result}"

  ports {
    internal = 80
    external = 9090
  }
}
```
![Cкриншот «Задание 1»](img/image1-2.png)

![Cкриншот «Задание 1»](img/image1-3.png)

```
resource "docker_container" "nginx" {
  image = docker_image.nginx.image_id
  name  = "hello_world"

  ports {
    internal = 80
    external = 9090
  }
```
Ключ -auto-approve автоматически подтверждает все изменения подтверждения . Это может привести к изменениям без предворительной проверки, что влечёт за собой все что угодно.

Уничтожаем c помощью: ```terraform destroy```

![Cкриншот «Задание 1»](img/image1-4.png)

Параметр ```keep_locally = true``` указывает терраформу не удалять образ при уничтожении.

```
resource "docker_image" "nginx" {
  name         = "nginx:latest"
  keep_locally = true
}
```
